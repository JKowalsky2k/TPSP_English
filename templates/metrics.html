<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<title>Metryki sędziowskie</title>
<link rel="stylesheet" href="static/metrics.css">
</head>
<body>

{% for squad, parcours in metrics.items() %}
    {% for parcour in parcours %}
    <section class="metric-page">
        <div class="metric-header">
            <div class="metric-header__group">Grupa {{ squad }}</div>
            <div class="metric-header__title">Metryka strzelań — {{ parcour.label }}</div>
        </div>

        <table class="metric-table">
            <thead>
                {% set header_labels = parcour.axis_labels if parcour.axis_labels is defined else series_range %}
                {% set total_columns = 2 + (header_labels|length * (shots_range|length + 2)) %}
                <tr>
                    <th rowspan="2" class="start-number">Numer startowy</th>
                    <th rowspan="2" class="name-cell">Nazwisko imię</th>
                    <th colspan="{{ header_labels|length * (shots_range|length + 2) }}" class="results-header">Wyniki strzelań</th>
                </tr>
                <tr>
                    {% for series in header_labels %}
                    <th colspan="{{ shots_range|length }}" class="series-cell series-group-start">
                        {% if series is string %}
                            {{ series }}
                        {% else %}
                            Seria {{ series }}
                        {% endif %}
                    </th>
                    <th class="series-cell">W</th>
                    <th class="series-cell series-group-end{% if loop.last %} last-group-end{% endif %}">P</th>
                    {% endfor %}
                </tr>
            </thead>
            <tbody>
                {% for competitor in parcour.competitors %}
                    {% set competitor_loop = loop %}
                    <tr class="shot-index-row">
                        <td class="start-number" rowspan="2">{{ competitor.number }}</td>
                        <td class="name-cell" rowspan="2">{{ competitor.name }}</td>
                        {% for series in series_range %}
                            {% set series_loop = loop %}
                            {% for shot in shots_range %}
                                {% set shot_loop = loop %}
                                {% set is_start = shot_loop.index0 == 0 %}
                                {% set is_end = shot_loop.last %}
                                {% if is_start %}
                                    {% set cell_class = 'series-group-start' %}
                                {% else %}
                                    {% set cell_class = '' %}
                                {% endif %}
                                {% set series_index = series_loop.index0 %}
                                {% set shot_index = shot_loop.index0 %}
                                <td class="{{ cell_class }}">
                                </td>
                            {% endfor %}
                            <td class="series-result-cell"></td>
                            <td class="series-signature-cell series-group-end{% if loop.last %} last-group-end{% endif %}"></td>
                        {% endfor %}
                    </tr>
                    <tr{% if not competitor_loop.last %} class="competitor-divider"{% endif %}>
                        {% for series_markers in competitor.markers %}
                            {% for marker in series_markers %}
                            {% if loop.index0 == 0 %}
                                {% set cell_class = 'series-group-start' %}
                            {% else %}
                                {% set cell_class = '' %}
                            {% endif %}
                            <td class="{{ cell_class }}"></td>
                            {% endfor %}
                            <td class="series-result-cell"></td>
                            <td class="series-signature-cell series-group-end{% if loop.last %} last-group-end{% endif %}"></td>
                        {% endfor %}
                    </tr>
                {% endfor %}
                <tr>
                    <td colspan="{{ total_columns }}" class="signature-row">Podpis sędziów:</td>
                </tr>
            </tbody>
        </table>
    </section>
    {% endfor %}
{% endfor %}

</body>
</html>
